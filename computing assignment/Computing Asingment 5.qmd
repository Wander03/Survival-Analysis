---
title: "Computing Assignment 5"
author: "Andrew Kerr"
format: pdf
editor: visual
embed-resources: true
---

# STAT 417: Survival Analysis Methods

## Computing Assignment 5: Due Friday 2-7-2025 at 11:59pm

You can browse through the document *Using R and R Studio for Survival Analysis* in the Week 5 module if you are unfamiliar with the R software. Additional R instructions/code for constructing the Kaplan-Meier estimator are provided at the end of the assignment.

------------------------------------------------------------------------

### **1. Dryer Failure Times**

Suppose a sample of 7 dryers is selected and the times until failure (in years) were observed for a period of 10 years. The following times were recorded:

| Dryer | 1   | 2   | 3   | 4   | 5   | 6   | 7   |
|-------|-----|-----|-----|-----|-----|-----|-----|
| Time  | 5   | 8   | 8   | 9   | 10+ | 10+ | 10+ |

where **“+”** indicates that the event time was right censored. Once you are in the R Studio environment, perform the following steps:

```{r}
# Load the survival package
library(survival)

# Create vectors for event times and censoring status

time <- c(5,8,8,9,10,10,10)
censor <- c(1,1,1,1,0,0,0)

# Compute Kaplan-Meier estimates
KM.obj <- survfit(Surv(time,censor)~1, conf.type="none")
```

**Tasks:**

1.  Compute the Kaplan-Meier estimates of survival for each complete event time.

```{r}
summary(KM.obj)
```

2.  Estimate the probability that a dryer will last longer than 6 years.

$S(6) = P(t>6) = 0.857$

3.  Estimate the median time until a dryer fails.

## $t_{.5} = 9$ years

### **2. Ovarian Cancer Survival Analysis**

The dataset `ovarian` (available in the `survival` package) contains follow-up times (in days) for ovarian cancer patients.

```{r}
# Load and analyze ovarian cancer survival data
KM.obj <- survfit(Surv(futime, fustat)~1, data=ovarian, conf.type="plain")
summary(KM.obj)
plot(KM.obj)
```

**Tasks:**

1.  Estimate the proportion of ovarian cancer patients who survived longer than 275 days.

$S(275) = 0.846$

2.  Find and report the 95% confidence interval for the probability that a randomly selected patient survives longer than 275 days.

The 95% confidence interval for S(275) is (0.707, 0.985). We are 95% confident that the true probability that a randomly selected ovarian cancer patient survives beyond 275 days is between .707 and .985.

3.  Modify the Kaplan-Meier estimator by setting `conf.type = "log-log"` and report the new confidence interval.

```{r}
KM.obj <- survfit(Surv(futime, fustat)~1, data=ovarian, conf.type="log-log")
summary(KM.obj)
```

The new 95% confidence interval for S(275) is (0.640, 0.939).

4.  Estimate the probability that a patient survives beyond 563 days.

$S(563) = 0.546$

5.  Discuss why the Kaplan-Meier curve does not reach 0 and what this implies about the treatment administered.

------------------------------------------------------------------------

### **3. Halibut Survival Study**

The dataset `Halibut` contains survival times (in hours) of 294 Atlantic halibut caught for an experiment on size regulation. The variable `TIME` represents survival time, and `CENSOR` is the censoring indicator (1 = complete event time, 0 = censored).

```{r}
# Load and analyze halibut survival data
KM.obj <- survfit(Surv(TIME, CENSOR)~1, data=halibut, conf.type="log-log")
summary(KM.obj)
plot(KM.obj)
```

**Tasks:**

1\. Comment on the survival experience of the halibut.

2\. Estimate the proportion of halibut that survive beyond 20 hours.

3\. Find and report the 95% confidence interval for survival beyond 20 hours.

4\. Report the estimated median halibut survival time and its 95% confidence interval.

------------------------------------------------------------------------

## **Instructions for Constructing Kaplan-Meier Curves in R**

1.  Open R Studio and load the `survival` package:

```{r}
library(survival)
```

2.  If entering data manually, create vectors for event times and censoring status:

```{r}
TIME <- c(...)  # Observed event times
CENSOR <- c(...)  # Censoring indicators
KM.obj <- survfit(Surv(TIME, CENSOR)~1)
```

3.  If loading a dataset:

```{r}
KM.obj <- survfit(Surv(TIME, CENSOR)~1, data=DATAFILE)
```

4.  View summary statistics:

```{r}
summary(KM.obj)
```

5.  Plot the Kaplan-Meier curve:

```{r}
plot(KM.obj)
```

6.  To compare groups:

```{r}
KM.obj <- survfit(Surv(TIME, CENSOR)~GROUP, data=DATAFILE)
```
